# KeePass Qt â†’ MFC Compatibility Validation Guide

## Overview

This package contains **8 test databases** generated by the Qt port of KeePass to validate full compatibility with the original MFC KeePass v1.x.

**Goal:** Verify that files saved by the Qt version can be opened correctly by MFC KeePass on Windows.

**Package Contents:**
- 8 KDB test files (`.kdb` format)
- This validation guide
- Content manifest (see MANIFEST.md for detailed specifications)

---

## Prerequisites

### Windows Setup

1. **Download KeePass 1.x (Classic Edition)**
   - Visit: https://keepass.info/download.html
   - Download "KeePass 1.x" (NOT KeePass 2.x)
   - Version 1.39+ recommended
   - Install to default location

2. **Transfer Files**
   - Copy entire `validation-package/` folder to your Windows machine
   - Preserve all `.kdb` files and documentation

3. **Prepare for Testing**
   - Close any other password managers
   - Have this guide open for reference
   - Prepare to document any failures

---

## Test Files & Passwords

| # | Filename | Password | Purpose | Expected Time |
|---|----------|----------|---------|---------------|
| 1 | `test-empty-aes.kdb` | `EmptyPass123` | Minimal database structure | < 5 sec |
| 2 | `test-simple-aes.kdb` | `SimplePass123` | Basic functionality (AES) | < 5 sec |
| 3 | `test-simple-twofish.kdb` | `TwofishPass123` | Twofish encryption | < 5 sec |
| 4 | `test-complex-aes.kdb` | `ComplexPass123` | Multiple groups/entries | < 5 sec |
| 5 | `test-unicode.kdb` | `UnicodePass123` | International characters | < 5 sec |
| 6 | `test-attachment.kdb` | `AttachPass123` | Binary attachment (100KB) | < 5 sec |
| 7 | `test-lowrounds.kdb` | `LowRoundsPass123` | Fast encryption (1K rounds) | < 1 sec |
| 8 | `test-highrounds.kdb` | `HighRoundsPass123` | High security (10M rounds) | 2-5 min |

**Note:** Test #8 will take several minutes to open due to 10 million key transformation rounds.

---

## Validation Procedure

### For Each Test File:

1. **Open KeePass 1.x** on Windows
2. **File â†’ Open Database** (or Ctrl+O)
3. **Select the test file**
4. **Enter the password** from table above
5. **Verify the database opens** without errors
6. **Check the content** matches expectations (see below)
7. **Mark the checkbox** in the validation checklist
8. **Document any issues** in the Issue Reporting section

---

## Test 1: Empty Database (AES)

**File:** `test-empty-aes.kdb`
**Password:** `EmptyPass123`
**Algorithm:** AES-256-CBC
**Key Rounds:** 600,000

### Expected Content:
- **Groups:** 1 group named "Backup"
- **Entries:** 0 entries
- **Notes:** This tests minimal valid KDB structure

### Validation Checklist:
- [x] File opens without error
- [x] Password accepted on first try
- [x] Shows exactly 1 group named "Backup"
- [x] Group contains 0 entries
- [x] No error messages or warnings

---

## Test 2: Simple Database (AES)

**File:** `test-simple-aes.kdb`
**Password:** `SimplePass123`
**Algorithm:** AES-256-CBC
**Key Rounds:** 600,000

### Expected Content:
- **Groups:** 1 group named "General"
- **Entries:** 1 entry in "General" group

**Entry Details:**
- **Title:** Sample Entry
- **Username:** testuser
- **Password:** TestPass456
- **URL:** https://example.com
- **Notes:** This is a test note

### Validation Checklist:
- [x] File opens without error
- [x] Shows 1 group named "General"
- [x] General group contains 1 entry
- [x] Entry title is "Sample Entry"
- [x] Username is "testuser"
- [x] Password is "TestPass456" (reveal to verify)
- [x] URL is "https://example.com"
- [x] Notes field contains "This is a test note"

---

## Test 3: Simple Database (Twofish)

**File:** `test-simple-twofish.kdb`
**Password:** `TwofishPass123`
**Algorithm:** Twofish
**Key Rounds:** 600,000

### Expected Content:
- **Groups:** 1 group named "General"
- **Entries:** 1 entry in "General" group

**Entry Details:**
- **Title:** Twofish Test
- **Username:** tfuser
- **Password:** TwoFish789
- **URL:** https://twofish.test
- **Notes:** Testing Twofish encryption

### Validation Checklist:
- [x] File opens without error (Twofish decryption works)
- [x] Shows 1 group named "General"
- [x] General group contains 1 entry
- [x] Entry title is "Twofish Test"
- [x] Username is "tfuser"
- [x] Password is "TwoFish789"
- [x] URL is "https://twofish.test"
- [x] Notes contain "Testing Twofish encryption"

---

## Test 4: Complex Hierarchy (AES)

**File:** `test-complex-aes.kdb`
**Password:** `ComplexPass123`
**Algorithm:** AES-256-CBC
**Key Rounds:** 600,000

### Expected Content:
- **Groups:** 3 groups (Personal, Work, Banking)
- **Entries:** 10 entries distributed across groups

**Group Structure:**
1. **Personal** (3 entries)
   - Email Account
   - Social Media
   - Cloud Storage

2. **Work** (3 entries)
   - Corporate Email
   - Project Management
   - VPN Access

3. **Banking** (4 entries)
   - Main Bank
   - Credit Card
   - Investment
   - Savings

### Validation Checklist:
- [x] File opens without error
- [x] Shows exactly 3 groups
- [x] Group names: "Personal", "Work", "Banking"
- [x] Personal group contains 3 entries
- [x] Work group contains 3 entries
- [x] Banking group contains 4 entries
- [x] Total entry count is 10
- [x] Sample entry: "Email Account" has username "user@email.com"
- [x] Sample entry: "Main Bank" has username "customer12345"

---

## Test 5: Unicode Content

**File:** `test-unicode.kdb`
**Password:** `UnicodePass123`
**Algorithm:** AES-256-CBC
**Key Rounds:** 600,000

### Expected Content:
- **Groups:** 1 group named "å›½é™…åŒ–æµ‹è¯• ðŸŒ" (Chinese + emoji)
- **Entries:** 5 entries with various Unicode characters

**Entry Languages:**
1. **ä¸­æ–‡æ ‡é¢˜** (Chinese)
2. **Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©** (Arabic)
3. **æ—¥æœ¬èªž** (Japanese)
4. **Ð ÑƒÑÑÐºÐ¸Ð¹** (Russian)
5. **Emoji Test ðŸ˜€** (Emojis)

### Validation Checklist:
- [x] File opens without error
- [ ] Group name displays correctly (Chinese + globe emoji)
- [ ] Chinese entry title "ä¸­æ–‡æ ‡é¢˜" displays correctly
- [ ] Arabic entry title "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©" displays correctly
- [ ] Japanese entry title "æ—¥æœ¬èªž" displays correctly
- [ ] Russian entry title "Ð ÑƒÑÑÐºÐ¸Ð¹" displays correctly
- [ ] Emoji entry title "Emoji Test ðŸ˜€" displays correctly
- [x] All 5 entries present in the group
Entries appear mostly as question marks.

**Note:** If characters display as boxes, MFC KeePass may need font configuration, but file should still open.

---

## Test 6: Binary Attachment

**File:** `test-attachment.kdb`
**Password:** `AttachPass123`
**Algorithm:** AES-256-CBC
**Key Rounds:** 600,000

### Expected Content:
- **Groups:** 1 group named "Attachments"
- **Entries:** 1 entry with binary attachment

**Entry Details:**
- **Title:** File with Attachment
- **Username:** fileuser
- **Password:** FilePass123
- **URL:** https://files.example.com
- **Notes:** Entry with 100KB binary attachment
- **Attachment:** `test-file.bin` (100 KB)

### Validation Checklist:
- [x] File opens without error
- [x] Shows 1 group named "Attachments"
- [x] Entry title is "File with Attachment"
- [x] Entry has attachment icon or indicator
- [x] Attachment filename is "test-file.bin"
- [x] Attachment size is approximately 100 KB (102,400 bytes)
- [x] Can view/save attachment without error

---

## Test 7: Low Key Rounds

**File:** `test-lowrounds.kdb`
**Password:** `LowRoundsPass123`
**Algorithm:** AES-256-CBC
**Key Rounds:** 1,000 (very low)

### Expected Content:
- **Groups:** 1 group named "General"
- **Entries:** 1 entry

**Entry Details:**
- **Title:** Low Rounds Test
- **Username:** lowuser
- **Password:** LowPass123
- **URL:** https://low.test
- **Notes:** Testing with 1,000 key rounds

### Validation Checklist:
- [x] File opens VERY QUICKLY (< 1 second)
- [x] Shows 1 group named "General"
- [x] Entry title is "Low Rounds Test"
- [x] Password is "LowPass123"
- [x] Notes mention "1,000 key rounds"

**Note:** This tests that low round counts don't break compatibility.

---

## Test 8: High Key Rounds

**File:** `test-highrounds.kdb`
**Password:** `HighRoundsPass123`
**Algorithm:** AES-256-CBC
**Key Rounds:** 10,000,000 (10 million)

### Expected Content:
- **Groups:** 1 group named "General"
- **Entries:** 1 entry

**Entry Details:**
- **Title:** High Rounds Test
- **Username:** highuser
- **Password:** HighPass123
- **URL:** https://high.test
- **Notes:** Testing with 10M key rounds

### Validation Checklist:
- [x] File opens successfully (EXPECT 2-5 MINUTE DELAY)
- [ ] KeePass shows progress indicator during key transformation
- [x] Shows 1 group named "General"
- [x] Entry title is "High Rounds Test"
- [x] Password is "HighPass123"
- [x] Notes mention "10M key rounds"

**âš ï¸ IMPORTANT:** This test intentionally takes several minutes. This is NORMAL and expected behavior for 10 million key transformation rounds. Do not cancel if it seems slow.

It turns out that the file was opened almost instantaneously so I could never see any progress indicator.

---

## Validation Results Summary

### Overall Checklist

- [x] All 8 files opened without errors
- [x] All passwords accepted on first attempt
- [x] All content matches expected specifications
- [x] No data corruption observed
- [x] No error dialogs or warnings
- [ ] Unicode characters displayed correctly (or with acceptable font limitations)
- [x] Binary attachment handled correctly
- [x] Both encryption algorithms work (AES, Twofish)
- [x] Extreme key rounds work (1,000 and 10,000,000)

### Test Results Table

| # | Test File | Status | Issues |
|---|-----------|--------|--------|
| 1 | test-empty-aes.kdb | â¬œ PASS | |
| 2 | test-simple-aes.kdb | â¬œ PASS | |
| 3 | test-simple-twofish.kdb | â¬œ PASS | |
| 4 | test-complex-aes.kdb | â¬œ PASS | |
| 5 | test-unicode.kdb | âŒ FAIL | file opens, but unicode characters display as question marks |
| 6 | test-attachment.kdb | â¬œ PASS |
| 7 | test-lowrounds.kdb | â¬œ PASS |
| 8 | test-highrounds.kdb | â¬œ PASS |

**Overall Result:** â¬œ ALL PASS / âŒ SOME FAILURES

---

## Issue Reporting

### If Any Test Fails:

Please document the following information:

**Test File:** [filename]
**Password Tried:** [password from table]
**Error Message:** [exact error text from KeePass]
**Behavior Observed:** [what happened]
**Expected Behavior:** [what should have happened]
**KeePass Version:** [1.xx]
**Windows Version:** [Windows 10/11/etc.]

### Common Issues & Troubleshooting

1. **"The composite key is invalid!"**
   - **Cause:** Wrong password or file corruption
   - **Action:** Verify password exactly matches table (case-sensitive)
   - **If persists:** File may be corrupted, report issue

2. **"The file is corrupted"**
   - **Cause:** Incompatible file format or serialization bug
   - **Action:** Report immediately with file details

3. **"Unknown encryption algorithm"**
   - **Cause:** Twofish not supported in your KeePass version
   - **Action:** Update to KeePass 1.39+ or report version details

4. **Unicode characters show as boxes**
   - **Cause:** Font configuration in Windows
   - **Action:** Not a failure if file opens and entries are present

5. **test-highrounds.kdb takes forever**
   - **Expected:** 2-5 minutes is normal for 10M rounds
   - **Action:** Wait patiently, KeePass should show progress

6. **File transfer corruption**
   - **Symptom:** Multiple files fail to open
   - **Action:** Verify file sizes, re-transfer package

---

## Optional: Round-Trip Test (Qt Validation)

If any issues are found, we may need to test MFC â†’ Qt compatibility.

### Create MFC Reference File (Optional):

1. **On Windows:** Open KeePass 1.x
2. **Create new database:**
   - File â†’ New Database
   - Password: `MFCTestPass123`
   - Algorithm: AES
   - Key Rounds: 600,000
3. **Add simple content:**
   - 1 group: "MFC Test Group"
   - 1 entry:
     - Title: "MFC Generated Entry"
     - Username: "mfcuser"
     - Password: "MFCPassword123"
     - URL: "https://mfc.test"
     - Notes: "This was created by MFC KeePass"
4. **Save as:** `mfc-reference.kdb`
5. **Transfer to Mac:** Send `mfc-reference.kdb` back to Mac

### On Mac (Qt):

I will create a unit test to open and verify your MFC reference file.

---

## Success Criteria

**Phase 1 Complete when:**
- âœ… All 8 test files open successfully in MFC KeePass
- âœ… All content matches specifications
- âœ… No errors or warnings
- âœ… Both encryption algorithms work (AES, Twofish)
- âœ… All key round configurations work (1K to 10M)
- âœ… Unicode and binary attachments handled correctly

**If all tests pass:** Qt port has achieved 100% MFC KeePass compatibility! ðŸŽ‰

---

## Questions or Issues?

If you encounter any problems or have questions about the validation process:

1. Document the issue using the reporting template above
2. Save your notes as `RESULTS.txt`
3. Create a GitHub issue with details
4. Include KeePass and Windows version information

---

## Technical Notes

### File Format Details

- **Format:** KDB v1.x (KeePass Database)
- **Version:** 0x00030004
- **Signatures:** 0x9AA2D903, 0xB54BFB65
- **Encryption:** AES-256-CBC or Twofish (256-bit)
- **Key Derivation:** AES-ECB transformation with configurable rounds
- **Hash:** SHA-256
- **Content Encoding:** UTF-8 (null-terminated strings)

### Why This Testing Matters

The Qt port must maintain **byte-level compatibility** with MFC KeePass to ensure:
- Users can migrate existing databases without conversion
- Databases are portable between platforms (Mac/Windows/Linux)
- No data loss or corruption during format transitions
- Long-term database preservation and accessibility

Your validation helps ensure the Qt port achieves these critical goals.

---

**Thank you for helping validate the Qt KeePass port!**

*Generated by Qt KeePass Validation Suite Generator*
*Last Updated: 2025-12-18*
